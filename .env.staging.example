# Staging Environment Configuration
# Copy this to .env.staging and fill in actual values
# DO NOT commit actual secrets to version control

# ============================================================================
# ENVIRONMENT
# ============================================================================
NODE_ENV=staging

# ============================================================================
# SERVER
# ============================================================================
PORT=4000
HOST=0.0.0.0

# URLs
API_URL=https://staging-api.syncwatch.example
WS_URL=wss://staging-api.syncwatch.example
FRONTEND_URL=https://staging.syncwatch.example

# ============================================================================
# DATABASE (PostgreSQL)
# ============================================================================
# Full connection string including password
# Rotation: Every 90 days
DATABASE_URL=postgresql://syncwatch_staging:CHANGE_ME@db:5432/syncwatch_staging

# Alternative: Use Docker Secrets (recommended)
# DATABASE_URL_FILE=/run/secrets/database_url

# Database credentials (for service configuration)
POSTGRES_USER=syncwatch_staging
POSTGRES_PASSWORD=CHANGE_ME_ROTATE_EVERY_90_DAYS
POSTGRES_DB=syncwatch_staging

# ============================================================================
# REDIS
# ============================================================================
# Redis connection string
# Rotation: Every 90 days (if password is used)
REDIS_URL=redis://:CHANGE_ME@redis:6379/0

# Alternative: Use Docker Secrets
# REDIS_URL_FILE=/run/secrets/redis_url

REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=CHANGE_ME_ROTATE_EVERY_90_DAYS
REDIS_DATABASE=0

# ============================================================================
# MINIO / S3 STORAGE
# ============================================================================
# MinIO credentials
# Rotation: Every 90 days
MINIO_ENDPOINT=minio
MINIO_PORT=9000
MINIO_USE_SSL=false
MINIO_BUCKET=syncwatch-staging
MINIO_REGION=us-east-1
MINIO_ACCESS_KEY=CHANGE_ME_ROTATE_EVERY_90_DAYS
MINIO_SECRET_KEY=CHANGE_ME_ROTATE_EVERY_90_DAYS

# Alternative: Use Docker Secrets
# MINIO_ACCESS_KEY_FILE=/run/secrets/minio_access_key
# MINIO_SECRET_KEY_FILE=/run/secrets/minio_secret_key

# ============================================================================
# JWT & AUTHENTICATION
# ============================================================================
# JWT signing secrets (minimum 32 characters)
# Rotation: Every 30 days
JWT_SECRET=CHANGE_ME_MINIMUM_32_CHARACTERS_ROTATE_EVERY_30_DAYS
JWT_REFRESH_SECRET=CHANGE_ME_MINIMUM_32_CHARACTERS_ROTATE_EVERY_30_DAYS

# Alternative: Use Docker Secrets
# JWT_SECRET_FILE=/run/secrets/jwt_secret
# JWT_REFRESH_SECRET_FILE=/run/secrets/jwt_refresh_secret

JWT_EXPIRES_IN=15m
JWT_REFRESH_EXPIRES_IN=7d

# Session secret (if using sessions)
SESSION_SECRET=CHANGE_ME_MINIMUM_32_CHARACTERS_ROTATE_EVERY_30_DAYS

# ============================================================================
# TURN / STUN SERVER (WebRTC)
# ============================================================================
# TURN server configuration
# Rotation: Every 7 days
TURN_SERVER_URL=turn:staging-turn.syncwatch.example:3478
TURN_SECRET=CHANGE_ME_ROTATE_EVERY_7_DAYS
TURN_CREDENTIAL_TTL=86400

# Alternative: Use Docker Secrets
# TURN_SECRET_FILE=/run/secrets/turn_secret

# ============================================================================
# CORS
# ============================================================================
CORS_ORIGINS=https://staging.syncwatch.example

# ============================================================================
# RATE LIMITING
# ============================================================================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_MAX=100
RATE_LIMIT_WINDOW_MS=60000

# ============================================================================
# VIDEO SETTINGS
# ============================================================================
MAX_UPLOAD_SIZE_MB=8192
MAX_VIDEO_DURATION_HOURS=3
VIDEO_EXPIRY_HOURS=72
MAX_ROOM_PARTICIPANTS=5

# ============================================================================
# WORKER CONFIGURATION
# ============================================================================
WORKER_CONCURRENCY=2
WORKER_MEMORY_LIMIT=4g

# ============================================================================
# OBSERVABILITY
# ============================================================================
LOG_LEVEL=info
ENABLE_METRICS=true
ENABLE_TRACING=true

# ============================================================================
# EXTERNAL SERVICES (Optional)
# ============================================================================
# Sentry error tracking (optional)
# SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id
# SENTRY_DSN_FILE=/run/secrets/sentry_dsn

# GitHub token (if needed for CI/CD)
# GITHUB_TOKEN=ghp_your_token_here
# Rotation: Annually or as needed

# ============================================================================
# DOCKER REGISTRY (for deployments)
# ============================================================================
DOCKER_REGISTRY=ghcr.io/visagedvachevsky
VERSION=staging-latest
